<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luminara | Discover Your Perfect Color Palette</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Define custom CSS variables for easy maintenance */
        :root {
            --lavender-mist: #EADFF7;
            --warm-sand: #F6EFE7;
            --dusty-rose: #F2D7DA;
            --sage-green: #C7D8C4;
            --soft-charcoal: #33303A;
            --shadow-soft: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.03);
            --transition-duration: 0.5s;
        }

        /* Set Poppins as the primary font */
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--warm-sand);
            color: var(--soft-charcoal);
            transition: background-color var(--transition-duration);
        }

        /* Custom scrollbar for aesthetic */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-thumb {
            background: var(--dusty-rose);
            border-radius: 10px;
        }
        ::-webkit-scrollbar-track { background: var(--warm-sand); }

        /* General component styling */
        .card {
            background-color: white;
            border-radius: 1.5rem; /* Large rounded corners */
            padding: 1.5rem;
            box-shadow: var(--shadow-soft);
            transition: all var(--transition-duration);
        }
        .main-button {
            transition: all 0.2s ease-in-out;
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            border-radius: 9999px;
        }
        .main-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        
        /* Loading Spinner */
        .spinner {
            border: 4px solid var(--lavender-mist);
            border-top: 4px solid var(--dusty-rose);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Utility for hiding and showing sections */
        .hidden-section {
            opacity: 0;
            max-height: 0;
            overflow: hidden;
            padding-top: 0;
            padding-bottom: 0;
            transition: opacity 0.5s ease-in-out, max-height 0.5s ease-in-out;
        }
        .visible-section {
            opacity: 1;
            max-height: 5000px; /* Large enough to accommodate content */
            transition: opacity 0.5s ease-in-out, max-height 0.8s ease-in-out;
        }
        .outfit-image {
            width: 100%;
            height: 200px; /* Increased height for better visual */
            object-fit: cover;
            border-radius: 0.75rem;
            margin-bottom: 0.75rem;
            background-color: #f0f0f0; /* Loading placeholder color */
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'lavender-mist': '#EADFF7',
                        'warm-sand': '#F6EFE7',
                        'dusty-rose': '#F2D7DA',
                        'sage-green': '#C7D8C4',
                        'soft-charcoal': '#33303A',
                    },
                },
            },
        }

        // --- Global State Variables ---
        let db, auth;
        let currentUserId = null;
        let stream = null; // To hold the camera stream
        let currentPage = 'landing-page'; // New state variable
        
        const APP_ID = typeof __app_id !== 'undefined' ? __app_id : 'default-luminara';
        
        // --- UPDATED MOCK RESULTS WITH REAL IMAGES ---
        const MOCK_RESULTS = [
            {
                undertone: 'Warm', season: 'Autumn', confidence: '94%',
                palette: [
                    { name: 'Terracotta', hex: '#E2725B' },
                    { name: 'Olive Green', hex: '#6B8E23' },
                    { name: 'Gold', hex: '#FFD700' },
                    { name: 'Bronze', hex: '#CD7F32' },
                    { name: 'Mustard', hex: '#FFDB58' },
                    { name: 'Rust', hex: '#B7410E' },
                    { name: 'Cream', hex: '#FFFDD0' },
                ],
                outfitTip: 'Warm undertones look radiant in earth tones. Try soft beige tops to highlight your natural glow and always choose gold jewelry.',
                outfits: [
                    { 
                        item: 'Kemeja Linen', 
                        color: 'Soft Beige', 
                        reason: `Aksen warna netral hangat yang sempurna untuk kegiatan sehari-hari.`, 
                        imageUrl: 'https://images.unsplash.com/photo-1596755094514-f87e34085b2c?auto=format&fit=crop&w=800&q=80' // Beige Linen
                    },
                    { 
                        item: 'Celana Kulot', 
                        color: 'Terracotta', 
                        reason: `Memberikan warna dasar yang kaya dan seimbang.`, 
                        imageUrl: 'https://images.unsplash.com/photo-1515886657613-9f3515b0c78f?auto=format&fit=crop&w=800&q=80' // Fashion Terracotta vibe
                    },
                    { 
                        item: 'Aksesori Emas', 
                        color: 'Gold (Kuning)', 
                        reason: `Emas melengkapi rona hangat kulit Anda secara alami.`, 
                        imageUrl: 'https://images.unsplash.com/photo-1570119859239-2a912f46258c?auto=format&fit=crop&w=800&q=80' // Gold Jewelry
                    },
                    { 
                        item: 'Scarf Motif', 
                        color: 'Mustard', 
                        reason: `Bawa warna komplementer dekat dengan wajah Anda.`, 
                        imageUrl: 'https://images.unsplash.com/photo-1585644198305-24c600100656?auto=format&fit=crop&w=800&q=80' // Mustard Fabric/Scarf
                    },
                ],
                cultural: [
                    { 
                        style: 'Balinese Kebaya', 
                        description: 'Kebaya dengan aksen **emas** meningkatkan kehangatan.', 
                        colors: ['Gold', 'Dark Red'],
                        imageUrl: 'https://images.unsplash.com/photo-1621644781442-9a3b2b9195b6?auto=format&fit=crop&w=800&q=80' // Bali aesthetic
                    },
                    { 
                        style: 'Palembang Songket', 
                        description: 'Songket Palembang oranye dan merah tua untuk tekstur kaya.', 
                        colors: ['Deep Orange', 'Red', 'Gold'],
                        imageUrl: 'https://images.unsplash.com/photo-1577717462479-05d5272a0af0?auto=format&fit=crop&w=800&q=80' // Traditional red/gold fabric
                    },
                ],
                skincareTip: 'Use a BB cream or foundation with a subtle yellow or golden base to keep your skin looking fresh and avoid pink-based makeup.',
            },
            {
                undertone: 'Cool', season: 'Winter', confidence: '92%',
                palette: [
                    { name: 'Navy Blue', hex: '#000080' },
                    { name: 'Emerald Green', hex: '#50C878' },
                    { name: 'Royal Purple', hex: '#7851A9' },
                    { name: 'Icy Pink', hex: '#F6C9CC' },
                    { name: 'True Black', hex: '#000000' },
                    { name: 'Bright White', hex: '#FFFFFF' },
                    { name: 'Gray', hex: '#808080' },
                ],
                outfitTip: 'Cool undertones shine in high-contrast and jewel tones. A crisp white shirt or neutral gray jackets balance your look perfectly.',
                outfits: [
                    { 
                        item: 'Blazer Set', 
                        color: 'Charcoal Gray', 
                        reason: `Warna abu-abu gelap memberikan kontras tinggi yang sempurna untuk cool tone.`, 
                        imageUrl: 'https://images.unsplash.com/photo-1591729647238-cb549318c8da?auto=format&fit=crop&w=800&q=80' // Grey Blazer
                    },
                    { 
                        item: 'Kemeja Putih', 
                        color: 'Bright White', 
                        reason: `Putih murni menciptakan kontras bersih yang menonjolkan kulit sejuk Anda.`, 
                        imageUrl: 'https://images.unsplash.com/photo-1598033129183-c4f50c736f10?auto=format&fit=crop&w=800&q=80' // White Shirt
                    },
                    { 
                        item: 'Kalung Minimalis', 
                        color: 'Silver/Platinum', 
                        reason: `Logam perak dan platinum memancarkan cahaya sejuk yang indah.`, 
                        imageUrl: 'https://images.unsplash.com/photo-1611591437281-460bfbe1220a?auto=format&fit=crop&w=800&q=80' // Silver chain
                    }, 
                    { 
                        item: 'Dress Midi', 
                        color: 'Navy Blue', 
                        reason: `Biru tua dingin meningkatkan kejernihan warna kulit Anda.`, 
                        imageUrl: 'https://images.unsplash.com/photo-1539008835657-9e8e9680c956?auto=format&fit=crop&w=800&q=80' // Dark blue dress
                    }, 
                    { 
                        item: 'Tas Tangan', 
                        color: 'True Black', 
                        reason: `Hitam adalah warna kontras utama yang membuat cool tone terlihat pop.`, 
                        imageUrl: 'https://images.unsplash.com/photo-1584917865442-de89df76afd3?auto=format&fit=crop&w=800&q=80' // Black Bag
                    },
                ],
                cultural: [
                    { 
                        style: 'Javanese Batik', 
                        description: 'Batik Jawa Klasik dalam warna **indigo** dan putih memberikan keanggunan.', 
                        colors: ['Indigo', 'White', 'Black'],
                        imageUrl: 'https://images.unsplash.com/photo-1612296489433-4f990928229e?auto=format&fit=crop&w=800&q=80' // Batik Parang/Kawung texture
                    },
                    { 
                        style: 'Batak Ulos', 
                        description: 'Kain Ulos dalam
